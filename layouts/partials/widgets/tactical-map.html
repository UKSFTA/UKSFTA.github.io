<div class="tactical-map-container relative w-full h-full bg-[#050505] overflow-hidden group/map">
    {{ $orbat := .Site.Data.orbat_v2 }}
    <!-- 1. The Tactical SVG Layer -->
    <svg viewBox="0 0 1000 1000" class="w-full h-full opacity-40 transition-opacity duration-1000 group-hover/map:opacity-80">
        <defs>
            <filter id="glow">
                <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
                <feMerge>
                    <feMergeNode in="coloredBlur"/>
                    <feMergeNode in="SourceGraphic"/>
                </feMerge>
            </filter>
            <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
                <path d="M 40 0 L 0 0 0 40" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="0.5"/>
            </pattern>
        </defs>

        <!-- Grid Background -->
        <rect width="100%" height="100%" fill="url(#grid)" />

        <!-- High-Fidelity UK Geometry -->
        <g class="map-geometry" stroke="var(--mod-purple)" stroke-width="0.5" fill="rgba(222, 142, 192, 0.05)" filter="url(#glow)">
            <path d="M431.8 567.2l0.3-0.5 0.1-0.7-0.3-2.1 0.2-0.6 0.3-0.1 0.1-0.1-0.2-0.7 1.3-2.1 0.5-0.5 0.6-0.5 2.9-0.4 0.4-0.5 0.4-0.5 0.4-0.6 0.9-0.3-0.4 1.5 0.7 0.1 2.1-0.7 0.9 0.1 1.3 0.7-0.1 0.1-1.1 1.3 1 1.1 1 2.8 0.8-0.3 1.3 0.3-0.5 1.6 0.2 1.9 0.5 1.3 1.4 1.1 0.4 1.9 0.5 0.6-0.3 1 0 2.4 1.4 1.9-1.7 0.1-1.1 0.7-1.8-0.7-0.3-0.8-2.2-2.2-1.6 0.5-0.5-0.2 0.5-0.7-0.6-0.7 0-1.5-3.2-0.3-0.1-0.6 0.9-1.3-0.1-0.3-2.6-0.7-1.3 0.6-1.3-0.2-0.9-1.6-1-0.5-0.1-0.1z" />
            <path d="M606.8 386.9l0.2-0.1 1.6-1.7 1.3-0.1 1.3-1.5 1.4-1 1.2-1.5 2.6-1.3 1.1 0 0.7-0.9 0.4-1.2-0.1-0.9 0.5-0.8-1.7-1.3 0.5-4.2-1.8-1.1-0.1-0.6 0.6-1 1.3-1.1 1.3-2.4 1.3-1.1 0.3-1-0.7-3.5-1.9-0.4-2.8-2.7-3.7 0.7-0.8 0.4-0.7 0.9-2.7 0.3-1.6 2-0.8 0.2-0.3-0.5 0.3-1 1.6-2-0.1-1.3 0.3-2.8-0.1-1.3-0.2-1.3-1.2-0.8 0.1-1.5-0.3-0.9 0.3-0.6 0.1-1-1-0.6-0.4-1.9-0.8-1.6 0-0.1 3.3-2.5 2.8-0.7-0.4 1-0.2 0.4-0.4 0.4 0.6 0.5 0.6 0 0.7-0.3 0.7-0.2-1-2.3 1.7 0.6 1 0.1 0.9-0.2 0.6-0.5 0.8-0.9 0.4-1.1-0.2-1 0.4-0.9 0.4-0.1 0.5 0.2 0.6 0.2 0.6-0.3 1.2-0.8 0.6-0.1 5.8 0.2 3.5 2.3 6.2 2.2 2 0.1 1.9-0.6 2.9-2.2 0.8-0.2 4.4 0 0 0.7 0 2.1 0 3.2 1.9 4.2 1.5 1.5 1.4 1.9 0.6 1.5 0 1.4-1.2 0.7-1.9-0.6-1.7-0.7-2.1-0.1-1.8 0.1-2 1.4-2.7 2.4-0.8 2.4-0.1 2.7 0.3 1.6 0.9 1.5 0.8 1.6 0.1 1.6 0 1.6-0.9 2.6-1.1 1.9-0.9 0.7-0.7 0-1.1-0.1-1.2-0.5-1.4-0.2-1 0.6-2.1 1.1-1.1 1.4-1 1.6-1.1 1.5-1.1 1.4-1.2 0.6-1.2 0.5-0.5 1.2-0.1 1.2 0.2 0.8 0.3 0.9 0.5 1.4 0 1.1-1 0.9-1.7 0.4-2.2 0.2-2.4 0-3.4 0-3.2 0-1.7-0.2-1.1-0.9z" />
            <path d="M787.3 743.5l1.2 0.2 3.6-2.7 0.2-0.5-0.8-1 0.6-1.9 0.2-0.3 0.3-0.1 1.8 0.2 0.8 0.4 1.3 1.9 0.7 0.4 0-0.5-0.2-1.3 0.9-1.4 1.2-1.4 0.6-1 0.3-1.9 0.6-2.1 0.7-1.9 0.6-1.3 1.7-1.7 2.3-1.1 2.5-0.5 2.3 0.1-0.4-0.6 1-0.3 1 0.2 1.1 0.5 1 0.2 3.9 0 1.9 0.5 2.1 1 2.3 0.6 2.1-1-0.5-0.4-0.6-0.2-0.5 0-0.6 0 0-0.5 14.4 3.5 5.7 2.9 11.6 9 1.4 1.6 1.1 1.9 0.9 3.6 0.8 2.3 0.6 2.3-0.3 1.6 0.3 1.2 0.1 1.5 0 2.8-0.1 0.1-0.2 0-2.4-0.8-0.8 0.2-0.5 0.5-0.5 1.7 1.1 1.4 1.1 0.3 0.1 0.9-0.4 0.5-0.3-0.4-1.2 1.2-1 0.5-1.9-1.2-0.7-0.1-0.5 0.6-0.1 1-1.3-0.6-1.1 0.5-1.4-0.6-1.2 0.5-1-0.7-0.6 0-0.3 0.5 0.9 0.9-0.1 0.2-1.4 0.3-2.3 1.1-1.2 2.4-0.6 0.6-2.3 0.1-1.9 1.6-1.5 0.5-1.9-0.2-1.7-0.6-2.2 0-2-0.7-2.9 1.1-2-1.7-2.3-0.1-2.1-0.9-2.3 1-1.7 0.2-0.8-0.7-1.9-0.1-1.1-0.7-0.2-1.1 0.2-0.5 1.8-1.4-1-0.2-0.5-0.5-1.8 0.5-3.7-0.5-3.2 1.2-2.1-0.1-2.3-1.8-1.5-2.1-0.1-0.6-1.6-0.9-2 0.2-1.1 1-0.5 0-0.8-1.5 0-0.7-0.6-0.5-0.2-1.6 0.5-1.4-0.5-0.9 0.1-0.9 1.2-1 0-0.3-2.9-2.2 0-0.5 0.8-1.1-0.2-0.8-1.8-0.7 0.7-4.2z" />
            <path d="M601.4 401.1l0.7-2.9 1.3-1.5 0.3-0.9-0.1-3.1 0.4-2.8-0.2-0.5 0.3-1 2.7-1.5 1.1 0.9 1.7 0.2 3.2 0 3.4 0 2.4 0 2.2-0.2 1.7-0.4 1-0.9 0-1.1-0.5-1.4-0.3-0.9-0.2-0.8 0.1-1.2 0.5-1.2 1.2-0.5 1.2-0.6 1.1-1.4 1.1-1.5 1-1.6 1.1-1.4 2.1-1.1 1-0.6 1.4 0.2 1.2 0.5 1.1 0.1 0.7 0 0.9-0.7 1.1-1.9 0.9-2.6 0-1.6-0.1-1.6-0.8-1.6-0.9-1.5-0.3-1.6 0.1-2.7 0.8-2.4 2.7-2.4 2-1.4 1.8-0.1 2.1 0.1 1.7 0.7 1.9 0.6 1.2-0.7 0-1.4-0.6-1.5-1.4-1.9-1.5-1.5-1.9-4.2 0-3.2 0-2.1 0-0.7 3 0 0.3 0.2 0.5 0.8 0.5 0.2 0.5-0.2 0.4-0.3 0.4 0 0.4 0.5 1.6-0.8 4 1.4 1.5 0 0.8 1.2 0.3-0.2 0.4-0.6 0.6-0.4 0.8 0.1 2.2 1.1 0.4-0.7 0.3 0.2 0.5 0.4 0.5 0.1 0.5-0.3 0.8-0.8 0.4-0.1 0.9 0.5 0.6 0.2 0.2-0.4 0.2-0.5 0.3-0.5 0.5-0.4 0.4-0.1 1 0.1 2 1.3 1 0.4 1.2-0.3 2.8-2.1 0.7-0.2 5.2 0.2 0 0.3 0.3 0.7 0.4 0.9 0.4 0.5 0.6 0 0.8-0.7 0.6 0.1 0.3 0.3 0.5 1.2 4 4.5 0.4 1.5 0.2 1.6 0.2 1.5 0.8 1.4 0 0.5-0.2 1.1 0.5 1 1.3 1.5-0.7 0.1-0.3 0.6 0.1 0.8 0.4 0.4 0.6 0.2-0.3 0.5-1.1 1-1.9 2.6-0.8 1.6-0.2 1.2-4.9 4.6-1.2 1.9-3 8-0.2-0.6-0.1-0.1-0.8-0.3-1 0-0.6 0-0.6 0-0.5 0.3-0.5 0.7-0.5 0.5-0.6 0-0.7 0-0.7-0.9-0.8-0.7-1.1-0.1-1.7 0.1-0.8 0.4-0.5 0.8-0.3 0.6-0.1 0.8 0.2 1.3 0.7 0.6 0.5 0.7 0.3 1.4-0.4 1.3-0.7 1.1-1.4 0-1.1 0-0.4 0.6-0.1 1.1 0.1 1.4 0.3 1 0.6 0.5 0.6 0 1.2-0.1 1.3-0.6 1.3-0.3 1.6-0.4 1.4-0.3 2-0.5 1.3-0.3 1.4 0.2 0.3 0.4 0.1 0.3 0 0.1-4.2 6.8-1.4 3.1-0.7 3.1 0.2 0.7 0.2 0.5 0.3 0.7 0 1-0.3 0.5-0.8 1.1-0.2 0.5-0.3 1.5-0.7 1-1.6 1.3-1.3 1.8-1.1 2-0.7 0.9-2.6 1.7-0.8 0.7-0.9 1-0.4 0.9-0.5-0.4-0.9 0-1.4 0.1-1.9-2.3-2.8-0.4-1.1-0.8-2.3-3.4 0.1-1.2-0.3-1.5 0.8-1.8 0.1-1-1-0.7-0.5-1.7-1.9-1.3-0.8-1.6-0.7-0.7-2.3 0-1.1-1.2-2-1-0.9 0.2-1.7 1.1-4.6-0.2-1.5 0.7-0.9 0.7-0.5 0.9-0.9 4.1-0.6 0.6-1.8-1.4-1.8-0.2-3.6-1.8-0.4 0.2-0.2 1.8-0.3 0.5-2.4 0.6-1.2 1.1-1.1 0-1.8-0.1-1.4 0.6-1.9-1.3-2.2 0.4-0.6-0.3-0.3-0.4 0-2.4-0.9-0.7-1.7 0.6-1.8-0.6-1.2 0.8-0.9 0.2-0.9-0.4-0.8-0.8-2.4 0.2z" />
            <path d="M640.7 773l1.1-0.3 0.8-0.9 1-0.4-0.5-0.9 0.1-0.5 1.5 0.4 1.5-1.2 1.7 0.8 0.7 1.1 0.3 1 2.3 0.1 0.2 0.8-0.8 1.3 2.3 1.6 1-0.2 0.4-1.8 0.6-0.5 0.6 0.3-0.1 0.7 0.5 2.4 0.8 1.1 0 0.8-0.2 1.1 0.6 0.8 1.2 0 1.4 0 1.1-0.1 0.7-0.6 0.5-0.6 0.6-0.5 0.7 0 1.2 0.5-0.3 0.7-0.3 1 0.2 0.5 0.8 0.5 1.1 0.3 0.5 1.1-0.2 2 0 1.7 0.2 1.1 0.6 0.9 0.8 0.3 0.7 0.4 0.5 1.1 0.1 1 0 1.3-0.1 1.8 0 1.9-0.1 1.1-0.8 0.1-1.1 1.4-0.9 0.4-0.8-0.4-0.6-1.4-0.9-0.5-0.5 1.7 0.2 0.8-0.5 0.9-0.1 1.3 0.9 0.7 0.3 1.4 1 1.1 0.1 0.9-0.1 0.5-1.7 1.1-1.7 0.2-0.6 1.6-1.5-0.2-1.3 0.5-0.3 0.8-0.6-0.2-1 0.7-0.5-1.2-0.3 0-0.3 0.5-0.2 1.9-0.1 0-0.5 0.3-0.8-0.6-0.9-0.8-0.3-0.2-0.4 0-0.8 0-0.3-0.1-0.2-0.1-0.2-0.3-0.2-0.4-0.1-0.2-0.6-0.8-0.1-0.2-0.5-0.6-4.6-4.2-0.5 0.1-0.5 0.2-1.4 1-0.5 0.3-0.3 0-0.5 0-0.4-0.2-1-0.9-0.3-0.3-0.2-0.4 0-0.5-0.1-0.3-0.1-0.2-0.1-0.1-1.4-1.2-1-1.5 0-0.1-1.4-2.5-0.1-0.4 0-0.6 0-0.4 0-0.6-0.1-0.4-0.1-0.3-0.9-0.9-0.4-0.4-0.3-0.1-0.1-0.2 0-0.2 0.3-1.3 0.2-0.7 0.1-0.2 0.2-0.3 0.2-0.1 0-0.2 0-0.1-0.7-0.4-0.3-0.5-0.1-0.3 0.1-0.2 0.5-0.2 1.2-0.5 0.2-0.2 0.2-0.3 0.1-0.4-0.1-0.2-0.2-0.1-0.2 0.1-0.3 0-0.3-0.1-0.4-0.5 0-0.4 0-0.3 1.9-2.8 0.3-0.4 0.2-0.9 0.1-0.3 0.2-0.2 0.2-0.2 0.6-0.3 0.2-0.2 0.1-0.2 0.4-0.5 0.1-0.1 0.2-0.2 0.4-0.2 1.6 0 0.3-0.2 0.3-0.3 0-0.2-0.1-0.2-0.2-0.2-1.2-0.3-0.2-0.3-0.2-0.3-0.1-0.8 0-0.2 0.1-0.5 0.3-0.5 0.3-0.3 1-0.7 0.3-0.4 0.1-0.3-0.1-0.7z" />
            <path d="M565.6 796.2l0.8 1 0.3 1.1 0.6 1.2 0.8 1.2 0.5 0.7 0 0.7-1 0.9-3.8 2.2-1.6 0.7-1-0.2-0.9 0-1 0.3-1.8 1.9-0.4 0.7 0 0.4 0.7 0.7 0.1 0.5 0 0.6-0.5 0.3-1.1 0.2-0.4 0.6 0 0.5 0.2 0.2 0.5 0.1 0.7 0 0.6 0 0.4-0.1 0.6-0.3 0.6-0.1 0.6 0 0.7 0.1 0.6 0.6 0.4 0.9 0.2 0.9 0 1.2 0 1.4 0 1.3-0.1 0.6 0 0.1-0.3 0.1-1.6 1.1 0 1.9-0.5 0-0.1 0.2 0 0.3-0.1 0.5-0.8 2.2-0.5-0.2-0.6-0.5-0.3 0.2-0.8 0.9-4.2-0.1-0.7 0.1-0.8 0.5-0.4 0.6-0.3 0.7-0.5 0.5-0.9 0.4-0.3 0.7-0.5 0.2-0.2-0.1-0.5-0.3-3-1-1.2-0.9 0.5-0.8-0.7-1.4-2.3-0.6-0.9-1.1 0.3-0.5 3.6 0.5-0.1-0.2-0.2-0.6-0.1-0.2 0.7-0.1 1.3 0.5 0.6 0.1 0.7-0.2 1.5-0.9 2.3-0.5 1.1-0.8 0.5-0.1 0.6 0.4 0-0.5-1.3-1.3-0.3-1.9 0.8-1.5 1.8-0.5 0-0.5-0.5 0.3-1.4 0.6-2.6 0.3-0.6 0.3 0.8 0 0.5 0.3 0.2 0.7-0.2 1.1 0.6 0.6-0.1 0.9-0.7 0.7-3.7 0.9-1 0-6.5-0.9-0.8 0.4 0.4 1.2-0.5 0.6-0.7 0 0.1-0.8 0-0.5-2.3-1.8-0.9-0.2 1-0.1 0.7-0.1 0.5-0.4 0.5-0.7 0.7-0.7 1.6-0.3 0.8-0.4 0.7-0.7 0.2-0.8-0.3-1.9 0-1.1-0.2-1.2-0.4-0.9-0.7-0.6-0.3 0.5-0.8-0.7-1.9-0.3-0.8-0.5-0.7 0.5-2.6 0.5-0.9 0 0.3-0.3 0.3-0.2 0-0.5-0.1-0.4-0.1-0.2 0.1-0.3 0.5-0.2 0-0.5-0.4-1 0.4-0.4 1.7-0.2 0.9-0.3 1.4-1.5 0.6-0.3 1.5-0.2 1.9-0.7 1.4-1.3 0.2-2 0.7 0 0-0.5-0.6-0.4 0.1-0.6 0.5-0.3 0.8-0.2 1.2 0.1 0.6 0.1 2.5 1.4 0.9 0 1.3-0.6-0.3-1 0.9 0.1 1.8 0.8 1 0.1 0.4-0.3 0-0.7-0.3-0.9 0.1-0.7 0.3-0.3 1.6-0.2 0.9-0.7 0.7-0.8 1.1-1.9 0.9-1 0.6 0 0.6 0.5 0 0.2-0.2 0.7 0 1.1 0.1 1 0.6 0.2 0.6 0 0.8 0 0.6 0.1 0.4 0.6 0.5 0.4 0.7 0.3 1.1 0.2 1.1 0.5z" />
            <path d="M567.5 907.3l-0.6 1.4 0.5 1.7-1.9 1.9-0.3 0.7 0 0.6 1.5 0.7 0.1 0.5-3 1.3-1.5-0.4-0.2 0.2-0.2 1.1-0.5 0.1-0.8-0.8-1.2-2.4-2.2-0.5-0.1 0.2 0.1 0.8-0.4 0.7-0.5 0.2-0.6-0.5-1.1 0.5 0.1 1.4-0.4 1-0.1 1.4-0.5 1 0.4 1.6-0.3 0.3-1.8-0.1-2.9 1.4-2 0.1-1.4 0.9-0.9-0.5-0.8 0.7-4.5 0.8-1.3 1.4-0.7-2.1-0.7-0.7-0.7 0.2-0.5-0.3-1.3 0.7 0.2-1.2-1-0.7 0.2-1.6-0.2-0.5-2-0.1-2.6 0.8-1.5-1.3 1-2.6-3 0.4-2.2-0.3-2.5-2.3-2.3-0.2-0.2-2-0.3-0.7-0.9-0.1-1-0.8-1.1 0.3-1.4-0.8-1.5 0.4-0.4 0.4-0.1 0.9-0.5 0.5-3.3-0.4-0.4-0.9 0.6-1.1 0.3-1.2-0.4-0.6-1.8 0.1-2-1.5-1.8-0.1-1.6-1.8-1.1-0.3-1.8-1.3-0.6-1-0.1-2.2 0.3-0.4 2.4 0.3 2.1-0.4 0.4-2-0.2-1.2 0.3-0.7 0-0.1 0.1-0.5 3.4 0.9 3.8-0.1 5.8 1.4 1.4 1.3 0.9 0.4 5.4-0.2 3.3-1.1 1.7-0.2 3.1 0.2 1.9-0.3 1.3-0.9 0.3 0.5-0.6 1 0.6 0.6 0.8-1.6 0.2-0.5 0.1-1-0.1-0.5-0.2-0.4-0.1-0.7 0-2.8-0.1-1.4-0.6-0.9 0.9 0.3 0.5-0.2 0.1 0 0.1 0.3 0.5 0.4 0.1 1.4 0.9 0.2 1.3-0.6 1.8 0.9 0.3 0 0.2-1.1 2 0.5 2.3-0.2 0.1-0.2-0.2-0.3-1.2-1.1-0.1-0.3 0.3-0.3 3.8 0.3 0.8 0.2 2.1 0.6 0.3 0.7 1.1 0.3 0.2 0.8 0.6 0.4 1.4 0 1.1-1 1.3-0.3 2.2 0.8 0.2 1 1.4 0.2 1.7-0.7 0.8-1.2 2.8-0.1 2.6-1.9 0.5-0.1 0.6 0.8-0.4 0.7 0.2 0.8 1.3 0.8 0.3 1.6-0.7 1.5-0.7 2.6-3.8 6.8-0.2 1 0.2 0.7 1.2 0.9z" />
        </g>
    </svg>

    <!-- 2. Dynamic Unit Nodes (Overlayed for better CSS control) -->
    <div class="absolute inset-0 z-30 pointer-events-none">
        {{ $units := .Site.Data.units }}
        {{ range $orbat.nodes }}
            {{ if eq .type "unit" }}
                <!-- Cluster Logic -->
                {{ $left := 0 }} {{ $top := 0 }} {{ $offset_x := 0 }} {{ $offset_y := 0 }}
                
                {{ if or (in .id "sas") (in .id "srr") }}
                    {{ $left = 63.5 }} {{ $top = 79.2 }}
                    {{ if in .id "sas_a" }} {{ $offset_x = -1.5 }} {{ $offset_y = 1.0 }}
                    {{ else if in .id "sas_b" }} {{ $offset_x = -2.5 }} {{ $offset_y = 2.0 }}
                    {{ else if in .id "sas_c" }} {{ $offset_x = -1.0 }} {{ $offset_y = 2.5 }}
                    {{ else if in .id "srr" }} {{ $offset_x = 1.5 }} {{ $offset_y = 0.5 }}
                    {{ end }}
                {{ else if in .id "sbs" }}
                    {{ $left = 67.5 }} {{ $top = 89.5 }}
                    {{ if in .id "sbs_a" }} {{ $offset_x = 1.5 }} {{ $offset_y = -0.5 }}
                    {{ else if in .id "sbs_b" }} {{ $offset_x = 2.5 }} {{ $offset_y = 0.5 }}
                    {{ else if in .id "sbs_c" }} {{ $offset_x = 1.0 }} {{ $offset_y = 1.5 }}
                    {{ end }}
                {{ else if or (in .id "tfhq") (in .id "uksf") }}
                    {{ $left = 77.0 }} {{ $top = 83.0 }}
                    {{ if in .id "tfhq" }} {{ $offset_x = -0.5 }} {{ $offset_y = -0.5 }}
                    {{ else if in .id "uksf" }} {{ $offset_x = 0.5 }} {{ $offset_y = 0.5 }}
                    {{ end }}
                {{ else if in .id "jsfaw" }}
                    {{ $left = 72.0 }} {{ $top = 85.0 }}
                    {{ if in .id "fw" }} {{ $offset_x = -1.0 }} {{ $offset_y = 0.5 }}
                    {{ else if in .id "rot" }} {{ $offset_x = 1.0 }} {{ $offset_y = 0.5 }}
                    {{ end }}
                {{ else if or (in .id "sfsg") (in .id "med") (in .id "intel") }}
                    {{ $left = 63.0 }} {{ $top = 82.0 }}
                    {{ if in .id "sfsg" }} {{ $offset_x = -1.5 }} {{ $offset_y = 0.0 }}
                    {{ else if in .id "med" }} {{ $offset_x = 0.0 }} {{ $offset_y = 1.5 }}
                    {{ else if in .id "intel" }} {{ $offset_x = 1.5 }} {{ $offset_y = 0.0 }}
                    {{ end }}
                {{ end }}

                <div class="unit-node absolute pointer-events-auto cursor-pointer group/unit" 
                     style="left: calc({{ $left }}% + {{ $offset_x }}%); top: calc({{ $top }}% + {{ $offset_y }}%); transform: translate(-50%, -50%);"
                     data-unit-id="{{ .id }}">
                    
                    <!-- The Pulse -->
                    <div class="absolute inset-0 w-full h-full bg-mod-green rounded-full animate-ping opacity-20"></div>
                    
                    <!-- The Icon/Shield -->
                    <div class="relative w-6 h-6 lg:w-7 lg:h-7 bg-mod-black border border-mod-purple/40 p-1 shadow-[0_0_10px_rgba(222,142,192,0.2)] transition-all duration-300 group-hover/unit:scale-125 group-hover/unit:border-mod-green group-hover/unit:shadow-[0_0_15px_rgba(0,255,133,0.4)]">
                        {{ $unit_info := index $units (lower .id) }}
                        {{ $icon_path := or .icon (and $unit_info $unit_info.icon) }}
                        {{ if $icon_path }}
                            {{ $icon := resources.Get $icon_path }}
                            {{ if $icon }}
                                <img src="{{ $icon.RelPermalink }}" class="w-full h-full object-contain no-invert opacity-80 group-hover/unit:opacity-100" alt="{{ .name }}">
                            {{ else }}
                                <div class="w-full h-full bg-mod-purple/20"></div>
                            {{ end }}
                        {{ else }}
                            <div class="w-full h-full bg-mod-purple/20"></div>
                        {{ end }}
                    </div>

                    <!-- Tactical Dossier (Hover) -->
                    <div class="absolute top-full left-1/2 -translate-x-1/2 mt-3 p-3 bg-mod-black/95 border border-mod-purple/30 backdrop-blur-md whitespace-nowrap opacity-0 group-hover/unit:opacity-100 transition-all duration-300 pointer-events-none z-50 shadow-2xl scale-95 group-hover/unit:scale-100">
                        <div class="flex flex-col gap-1.5 min-w-[120px]">
                            <div class="flex justify-between items-center border-b border-mod-purple/20 pb-1">
                                <span class="text-[9px] font-industrial font-black text-white uppercase tracking-tighter">{{ .name }}</span>
                                <span class="text-[6px] font-mono text-mod-green font-bold">ACTIVE</span>
                            </div>
                            <div class="space-y-0.5">
                                <span class="text-[6px] font-mono text-white/40 uppercase block tracking-widest">Callsign: {{ .callsign | default "--" }}</span>
                                <span class="text-[6px] font-mono text-white/40 uppercase block tracking-widest">AOR: UK_CONUS</span>
                                <span class="text-[6px] font-mono text-mod-purple uppercase block tracking-widest mt-1 opacity-60">Status: Nominal_Uplink</span>
                            </div>
                        </div>
                        <!-- Decorative Corners -->
                        <div class="absolute top-0 left-0 w-1 h-1 border-t border-l border-mod-green/40"></div>
                        <div class="absolute bottom-0 right-0 w-1 h-1 border-b border-r border-mod-green/40"></div>
                    </div>
                </div>
            {{ end }}
        {{ end }}
    </div>

    <!-- 3. System Meta Decoration -->
    <div class="absolute top-4 left-4 z-40 font-mono text-[7px] text-mod-purple uppercase tracking-[0.4em] pointer-events-none">
        <div class="flex flex-col gap-1">
            <span>// Strat_Asset_Mapping_V9.0</span>
            <div class="flex items-center gap-2">
                <span class="w-1 h-1 bg-mod-green rounded-full animate-pulse"></span>
                <span class="text-white/20">Sync_Pulse: Nominal</span>
            </div>
        </div>
    </div>
</div>

<style>
.unit-node {
    transition: z-index 0s;
}
.unit-node:hover {
    z-index: 100;
}
.unit-node img {
    filter: drop-shadow(0 0 3px rgba(0, 0, 0, 0.5));
}
</style>
