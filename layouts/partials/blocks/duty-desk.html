<div class="govuk-grid-row">
  <div class="govuk-grid-column-one-half">
    <div class="govuk-panel govuk-panel--confirmation" style="background-color: #13284c; text-align: left;">
      <h2 class="govuk-panel__title" style="font-size: 1.5rem;">Steam Server Status</h2>
      <div class="govuk-panel__body">
        <strong>Players:</strong> {{ .Site.Data.server_stats.current_players }}/{{ .Site.Data.server_stats.max_players }}<br>
        <strong>Map:</strong> {{ .Site.Data.server_stats.map }}<br>
        <strong>Status:</strong> <span style="color: #00ce7d;">{{ .Site.Data.server_stats.status }}</span>
      </div>
    </div>
  </div>
  
  <div class="govuk-grid-column-one-half">
    <div class="govuk-panel govuk-panel--confirmation" style="background-color: #153e35; text-align: left;">
      <h2 class="govuk-panel__title" style="font-size: 1.5rem;">Battlemetrics Analytics</h2>
      <div class="govuk-panel__body">
        <strong>Global Rank:</strong> #{{ .Site.Data.external.battlemetrics.rank }}<br>
        <strong>30-Day Uptime:</strong> {{ .Site.Data.external.battlemetrics.uptime }}<br>
        <strong>Status:</strong> NOMINAL
      </div>
    </div>
  </div>
</div>

<div class="govuk-grid-row govuk-!-margin-top-6">
  <div class="govuk-grid-column-full">
    <h3 class="govuk-heading-m">Operational Activity (30 Days)</h3>
    <canvas id="activityChart" width="400" height="150"></canvas>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const ctx = document.getElementById('activityChart').getContext('2d');
    const data = {{ .Site.Data.external.battlemetrics.activity_30d | jsonify | safeJS }};
    
    new Chart(ctx, {
      type: 'line',
      data: {
        labels: ['Wk 1', 'Wk 2', 'Wk 3', 'Wk 4', 'Wk 5', 'Wk 6', 'Wk 7'],
        datasets: [{
          label: 'Active Personnel',
          data: data,
          borderColor: '#532a45',
          backgroundColor: 'rgba(83, 42, 69, 0.1)',
          fill: true,
          tension: 0.4
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: {
            beginAtZero: true,
            grid: { color: 'rgba(0,0,0,0.05)' }
          },
          x: { grid: { display: false } }
        },
        plugins: {
          legend: { display: false }
        }
      }
    });
  });
</script>
