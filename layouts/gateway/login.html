{{ define "main" }}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-l">{{ .Title }}</h1>
    <p class="govuk-body">{{ .Content }}</p>

    <div class="govuk-warning-text">
      <span class="govuk-warning-text__icon" aria-hidden="true">!</span>
      <strong class="govuk-warning-text__text">
        <span class="govuk-warning-text__assistive">Warning</span>
        Tier 3 Access Level Required. SQL Signature Analysis active.
      </strong>
    </div>

    <form id="sqli-form">
      <div class="govuk-form-group" id="username-group">
        <label class="govuk-label" for="username">Username</label>
        <input class="govuk-input" id="username" name="username" type="text">
      </div>
      <div class="govuk-form-group" id="password-group">
        <label class="govuk-label" for="password">Password</label>
        <input class="govuk-input" id="password" name="password" type="password">
      </div>
      <button class="govuk-button" id="login-btn" type="button">Access System</button>
    </form>

    <div id="auth-result" class="govuk-body govuk-!-margin-top-4"></div>
  </div>
</div>

<script>
document.getElementById('login-btn').addEventListener('click', function() {
  const user = document.getElementById('username').value;
  const pass = document.getElementById('password').value;
  const result = document.getElementById('auth-result');

  // Tier 3 Mock SQL Injection Check
  // The expected payload is ' OR 1=1--
  if (user.includes("' OR 1=1--") || pass.includes("' OR 1=1--")) {
    result.innerHTML = '<span style="color:#00ce7d">AUTHENTICATION BYPASS DETECTED. SESSION GRANTED. FLAG: UKSF{S3QU3L_VULN_1DENT1F1ED}</span>';
    localStorage.setItem('rsis_session', 'verified_tier_3');
  } else {
    result.innerHTML = '<span style="color:#ff8200">AUTHENTICATION FAILED: INVALID CREDENTIALS OR SIGNATURE DISCREPANCY.</span>';
  }
});
</script>
{{ end }}
